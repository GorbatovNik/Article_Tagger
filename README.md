# Article Tagger

[Демо-приложение на Streamlit](https://article-tagger.streamlit.app/) 

Первый старт может быть долгим (2-3 минуты). Если на старте возникает ошибка с импортом библиотек - перезагрузите страницу. Проблема на стороне StreamLit

## Датасет и постановка задачи

Использовалась часть (100 000 записей) датасета **arXiv-metadata-oai-snapshot-111**, содержащего метаинформацию о статьях из различных научных областей.

**Задача:**  
По названию статьи и (опционально) аннотации определить, к каким из 8 категорий относится статья.  
Тип задачи: **многоклассовая классификация с несколькими метками** (*multi-label classification*).

### Категории:
- Computer Science  
- Economics  
- Statistics  
- Math  
- Electrical Engineering and Systems Science  
- Physics  
- Quantitative Biology  
- Quantitative Finance  

На вход модели подавался текст, полученный склеиванием **названия и аннотации**. Использовались только **первые 128 токенов**.

Для аугментации: в **30% случаев аннотация отбрасывалась**, имитируя неполные данные.

---

## Модель

Основная модель: `FacebookAI/roberta-base`  
Это сбалансированное решение между качеством и размером.

Так как задача **multi-label**, вместо top-N или softmax (как в single-label задачах), используется:
- **Функция активации:** `BCEWithLogitsLoss`
- **Порог:** `logit > 0` или `sigmoid > 0.5`

---

## Обучение

Обучение проводилось с использованием `Trainer` из библиотеки **Hugging Face Transformers**.

**Параметры обучения:**
- Эпохи: **2**
- Batch size: **32**
- Learning rate: **разный для энкодера и головы классификатора**  
  (у головы — в ~100 раз выше)
- Scheduler: **Linear**
- Warmup: **да**
- Оптимизатор: **AdamW**

---

## Метрики (на отложенной выборке)

| Метрика         | Значение |
|------------------|----------|
| Precision (micro) | 0.8988   |
| Recall (micro)    | 0.8461   |
| F1-score (micro)  | 0.8717   |

---

## Альтернативный эксперимент

Baseline-модель: `distilroberta-base`  
Это облегчённая версия, которая обеспечивает более быструю тренировку и инференс, но уступает по качеству.

| Метрика         | Значение |
|------------------|----------|
| Precision (micro) | 0.8149   |
| Recall (micro)    | 0.7682   |
| F1-score (micro)  | 0.7909   |

---

## Деплой

Приложение реализовано через **Streamlit** и развернуто на **Streamlit Cloud**.

Модель загружается с **Hugging Face Hub**:  
`Transformer/article-tagger`

Кэширование загрузки модели реализовано с помощью декоратора:

```python
@st.cache_resource
def load_model():
    ...
